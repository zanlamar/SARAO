<div class="preview-wrapper">
    @if (isCreating()) {
        <div class="preview-top-buttons">
            <button class="btn-back" (click)="onEdit()"> < EDIT</button>
            <button class="btn-next" (click)="onConfirm()">CONFIRM ></button>
        </div>
    } @else {
        <div class="preview-top-buttons">
            <button class="btn-back" (click)="onBack()"> < BACK</button>
        </div>
    }

    <main class="preview-container">
        @if (event()) {
        <div class="preview-content">
            <h1 class="preview-title">{{ event()?.title }}</h1>
            <div class="preview-image">
                @if (event()?.imageUrl && event()?.imageUrl !== '') {
                    <img [src]="event()?.imageUrl" alt="{{ event()?.title }}" />
                } @else {
                    <div class="image-placeholder">üìÖ</div>
                }
            </div>

            <div class="preview-main-details">
                <div class="main-detail">
                    <span class="main-label">üìÖ DATE</span>
                    <span class="main-value">{{ event()?.eventDateTime | date: 'fullDate' }}</span>
                </div>
                <div class="main-detail">
                    <span class="main-label">‚è∞ TIME</span>
                    <span class="main-value">{{ event()?.eventDateTime | date: 'shortTime' }}</span>
                </div>
                <div class="main-detail">
                    <span class="main-label">üìç WHERE</span>
                    <span class="main-value">{{ event()?.location?.alias }}</span>
                </div>

                <div class="main-detail">
                    <span class="main-label">üíÉ CAN I BRING SOMEONE?</span>
                    <span class="extra-value">
                        {{ event()?.allowPlusOne ? 'YAYYYY' : 'Nope, sorry' }}
                    </span>
                </div>
            </div>
            
            <div class="preview-description">
                <h3 class="description-title">LISTEN UP</h3>
                <p>{{ event()?.description }}</p>
            </div>
            

            
            @if (event()?.bringList && event()?.bringListItems && event()?.bringListItems!.length > 0) {
                <div class="preview-extras">
                    <app-bringlist 
                        [readonly]="true"
                        [items]="event()!.bringListItems ?? []">
                    </app-bringlist>
                </div>
            }

            @if (!isCreating() && !isHost) {
                <div class="rsvp-section">
                    <h3 class="rsvp-title">RSVP</h3>
                    <div class="rsvp-buttons">
                        <button 
                            class="rsvp-btn rsvp-yes"
                            (click)="onRSVP('yes')"
                            [disabled]="rsvpResponse() === 'yes'"
                        >
                            <span class="rsvp-icon">‚úÖ</span>
                            <span class="rsvp-label">YES</span>
                        </button>
                        <button 
                            class="rsvp-btn rsvp-maybe"
                            (click)="onRSVP('maybe')"
                            [disabled]="rsvpResponse() === 'maybe'"
                        >
                            <span class="rsvp-icon">ü§î</span>
                            <span class="rsvp-label">MAYBE</span>
                        </button>
                        <button 
                            class="rsvp-btn rsvp-no"
                            (click)="onRSVP('no')"
                            [disabled]="rsvpResponse() === 'no'"
                        >
                            <span class="rsvp-icon">‚ùå</span>
                            <span class="rsvp-label">NO</span>
                        </button>
                    </div>
                </div>
            }
            @if (event()?.location?.latitude && event()?.location?.longitude) {
                <div class="preview-where">
                    <span class="main-label">üìç ADRESS</span>
                    <span class="main-value">{{ event()?.location?.address }}</span>
                </div>

                <div class="map-section">
                    <app-preview-map 
                        [latitude]="event()?.location?.latitude"
                        [longitude]="event()?.location?.longitude"
                        [address]="event()?.location?.address || event()?.location?.alias || ''">
                    </app-preview-map>
                </div>
            }
        </div>
    } @else {
        <div class="no-event">
            <p>No event to preview</p>
        </div>
    }
    </main>
    <!-- <app-footer></app-footer> -->
</div>
