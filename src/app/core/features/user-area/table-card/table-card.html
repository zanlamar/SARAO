<p-card class="event-card">

    <ng-template pTemplate="header">
        <div class="event-header">
            <div class="event-header-content">
                <h3 class="event-title">{{ event.title }}</h3>
            </div>
        </div>
        <div class="event-details">
            <div class="event-location">
                    <i class="pi pi-map-marker"></i>
                    {{ event.location.alias }}
            </div>
            <div class="event-date">
                <i class="pi pi-calendar"></i>
                {{ event.eventDateTime | date:'short' }}
            </div>
        </div>
    </ng-template>

    <div class="event-body">

        <div class="event-stats">
            <div class="event-stat confirmed">
                <span>Confirmed:</span>
                <span class="value">{{ event.confirmed }}</span>
            </div>

            <div class="event-stat not-coming">
                <span>Not coming:</span>
                <span class="value">{{ event.notComing }}</span>
            </div>

            <div class="event-stat maybe">
                <span>Maybe:</span>
                <span class="value">{{ event.undecided }}</span>
            </div>

            <div class="event-stat pending">
                <span>Pending:</span>
                <span class="value">{{ event.pending }}</span>
            </div>
        </div>

        <button
            pButton
            class="p-button-rounded p-button-sm event-button"
            (click)="onMoreInfo()">
            See who
        </button>

    </div>

</p-card>

<p-dialog
    header="{{ event.title }}"
    [(visible)]="showModal"
    [modal]="true"
    [dismissableMask]="true"
    [style]="{ width: '90vw', maxWidth: '500px' }"
    class="attendees-modal">

    <div class="status-block">
        <h3>‚úÖ Confirmed</h3>
        @if (attendees?.confirmed?.length) {
            <ul>
                @for (email of attendees?.confirmed ?? []; track email) {
                    <li class="email-row">
                        <span>{{ email }}</span>
                        <i class="pi pi-envelope email-icon"></i>
                    </li>
                }
            </ul>
        } @else {
            <p class="empty-state">No confirmed guests</p>
        }
    </div>


    <div class="status-block">
        <h3>‚ùå Not Coming</h3>
        @if (attendees?.notComing?.length) {
            <ul>
                @for (email of attendees?.notComing?? [];track email) {
                    <li class="email-row">
                        <span>{{ email }}</span>
                        <i class="pi pi-envelope email-icon"></i>
                    </li>
                }
            </ul>
        } @else {
            <p class="empty-state">No one rejected</p>
        }
    </div>

    <div class="status-block">
        <h3>ü§î Maybe</h3>
        @if (attendees?.undecided?.length) {
            <ul>
                @for (email of attendees?.undecided ?? []; track email) {
                    <li class="email-row">
                        <span>{{ email }}</span>
                        <i class="pi pi-envelope email-icon"></i>
                    </li>
                }
            </ul>
        } @else {
            <p class="empty-state">No maybe responses</p>
        }
    </div>

    <div class="status-block">
        <h3>‚è≥ Pending</h3>
        @if (attendees?.pending?.length) {
            <ul>
                @for (email of attendees?.pending ?? []; track email) {
                    <li class="email-row">
                        <span>{{ email }}</span>
                        <i class="pi pi-envelope email-icon"></i>
                    </li>
                }
            </ul>
        } @else {
            <p class="empty-state">No pending responses</p>
        }
    </div>


</p-dialog>